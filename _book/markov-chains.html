<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 2 Markov Chains | Essentials of Mathematics and Statistics</title>
<meta name="author" content="Anas A Rana">
<meta name="description" content="We will now look at a Markov Chain. We have not covered it during lectures but based on the basic principles we have covered we will be able to use it for simulations. Any random process is known...">
<meta name="generator" content="bookdown 0.39 with bs4_book()">
<meta property="og:title" content="Chapter 2 Markov Chains | Essentials of Mathematics and Statistics">
<meta property="og:type" content="book">
<meta property="og:description" content="We will now look at a Markov Chain. We have not covered it during lectures but based on the basic principles we have covered we will be able to use it for simulations. Any random process is known...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 2 Markov Chains | Essentials of Mathematics and Statistics">
<meta name="twitter:description" content="We will now look at a Markov Chain. We have not covered it during lectures but based on the basic principles we have covered we will be able to use it for simulations. Any random process is known...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><link href="libs/Manrope-0.4.9/font.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Fira%20Code:wght@100&amp;display=swap" rel="stylesheet">
<link href="libs/Spectral-0.4.9/font.css" rel="stylesheet">
<script src="libs/bs3compat-0.7.0/transition.js"></script><script src="libs/bs3compat-0.7.0/tabs.js"></script><script src="libs/bs3compat-0.7.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Essentials of Mathematics and Statistics</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Introduction to the Practical</a></li>
<li><a class="" href="getting-started-in-r-and-rstudio.html">Getting started in R and Rstudio</a></li>
<li><a class="" href="data-sets.html">Data sets</a></li>
<li><a class="" href="simulating-random-numbers.html"><span class="header-section-number">1</span> Simulating random numbers</a></li>
<li><a class="active" href="markov-chains.html"><span class="header-section-number">2</span> Markov Chains</a></li>
<li><a class="" href="mc-solution.html">Solution: 3 state Markov Chain</a></li>
<li><a class="" href="a-monopoly-simulation.html"><span class="header-section-number">3</span> A Monopoly simulation</a></li>
<li><a class="" href="monopolySol.html">Solutions: Monopoly</a></li>
<li><a class="" href="monte-carlo-methods.html"><span class="header-section-number">4</span> Monte Carlo Methods</a></li>
<li><a class="" href="solution-monte-carlo.html">Solution: Monte Carlo</a></li>
<li><a class="" href="maximum-likelihood.html"><span class="header-section-number">5</span> Maximum Likelihood</a></li>
<li><a class="" href="sol-mle.html">Solution: Model Answers: MLE</a></li>
<li><a class="" href="confidence-intervals.html"><span class="header-section-number">6</span> Confidence Intervals</a></li>
<li><a class="" href="sol-ex-CI.html">Model Answer: Confidence Interval</a></li>
<li><a class="" href="computational-testing-techniques.html"><span class="header-section-number">7</span> Computational Testing Techniques</a></li>
<li><a class="" href="model-answers-computational-testing.html">Model Answers: Computational Testing</a></li>
<li><a class="" href="practical-linear-regression.html"><span class="header-section-number">8</span> Practical: Linear regression</a></li>
<li><a class="" href="solutions-linear-regression-and-correlation.html">Solutions: Linear regression and Correlation</a></li>
<li><a class="" href="practical-principal-component-analysis.html"><span class="header-section-number">9</span> Practical: Principal component analysis</a></li>
<li><a class="" href="practical-multiple-regression.html"><span class="header-section-number">10</span> Practical: Multiple regression</a></li>
<li><a class="" href="practical-generalised-linear-models.html"><span class="header-section-number">11</span> Practical: Generalised linear models</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/anasrana/ems-practicals">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="markov-chains" class="section level1" number="2">
<h1>
<span class="header-section-number">2</span> Markov Chains<a class="anchor" aria-label="anchor" href="#markov-chains"><i class="fas fa-link"></i></a>
</h1>
<!-- In this practical you will learn a number of techniques in R that you will use to simulate simplified games of Monopoly (<https://en.wikipedia.org/wiki/Monopoly_(game)>). In addition, there are also many tutorials and guides on the Web describing how to produce computer simulations for Monopoly. You are welcome to read and use these examples to inspire your work. -->
<p>We will now look at a <strong>Markov Chain</strong>. We have not covered it during lectures but based on the basic principles we have covered we will be able to use it for simulations.</p>
<p>Any random process is known to have the <em>Markov property</em> (a Markov process) if the probability of going to the next state depends only on the current state and not on the past states. A Markov process is <strong>memoryless property</strong> in that it does not store any property or memory of its past states.</p>
<p>If a Markov process operates within a specific (finite) set of states, it is called a <strong><em>Markov Chain</em></strong>.</p>
<p>A Markov Chain is defined by three properties:</p>
<ol style="list-style-type: decimal">
<li><p>A state space: a set of values or states in which a process could exist</p></li>
<li><p>A transition matrix: defines the probability of moving from one state to another state</p></li>
<li><p>A current state probability distribution: defines the probability of being in any one of the states at the start of the process</p></li>
</ol>
<p>Consider the following example where we have two states describing the weather on any particular day: (i) Sunny and (ii) Rainy. Each arrow denotes the probability of going from one state to itself or another over the course of a day. For example, if it is currently sunny, the probability of it raining the next day is 0.6. Conversely, if it is raining, the probability that it will become sunny the next day is 0.7 and 0.3 that it will continue raining.</p>
<div class="inline-figure"><img src="05-markov-chains_files/figure-html/unnamed-chunk-1-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>The transition matrix can be written as the following in R:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb13-1"><a href="markov-chains.html#cb13-1"></a>transitionMatrix <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.7</span>, <span class="fl">0.3</span>), <span class="at">nrow=</span><span class="dv">2</span>, <span class="at">ncol=</span><span class="dv">2</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb13-2"><a href="markov-chains.html#cb13-2"></a><span class="fu">print</span>(transitionMatrix)</span></code></pre></div>
<pre class="bg-info"><code>#&gt;      [,1] [,2]
#&gt; [1,]  0.4  0.6
#&gt; [2,]  0.7  0.3</code></pre>
<p>which creates a 2 x 2 matrix consisting of the transition probabilities shown in the diagram.</p>
<p>Suppose I want to simulate a sequence of 30 days and the weather patterns over those days. Assuming that on day 0 it is currently sunny, I can do the following:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb15-1"><a href="markov-chains.html#cb15-1"></a><span class="co"># initial state - it is [1] sunny or [2] rainy</span></span>
<span id="cb15-2"><a href="markov-chains.html#cb15-2"></a>state <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb15-3"><a href="markov-chains.html#cb15-3"></a>weather_sequence <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">30</span>) <span class="co"># vector to store simulated values</span></span>
<span id="cb15-4"><a href="markov-chains.html#cb15-4"></a><span class="cf">for</span> (day <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>) { <span class="co"># simulate for 30 days</span></span>
<span id="cb15-5"><a href="markov-chains.html#cb15-5"></a>  pr <span class="ot">&lt;-</span> transitionMatrix[state, ] <span class="co"># select the row of transition probabilities</span></span>
<span id="cb15-6"><a href="markov-chains.html#cb15-6"></a></span>
<span id="cb15-7"><a href="markov-chains.html#cb15-7"></a>  <span class="co"># sample [1] or [2] based on the probs pr</span></span>
<span id="cb15-8"><a href="markov-chains.html#cb15-8"></a>  state <span class="ot">=</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> pr)</span>
<span id="cb15-9"><a href="markov-chains.html#cb15-9"></a>  weather_sequence[day] <span class="ot">&lt;-</span> state <span class="co"># store the sampled state</span></span>
<span id="cb15-10"><a href="markov-chains.html#cb15-10"></a>}</span>
<span id="cb15-11"><a href="markov-chains.html#cb15-11"></a></span>
<span id="cb15-12"><a href="markov-chains.html#cb15-12"></a><span class="co"># print the simulated weather sequence</span></span>
<span id="cb15-13"><a href="markov-chains.html#cb15-13"></a><span class="fu">print</span>(weather_sequence)</span></code></pre></div>
<pre class="bg-info"><code>#&gt;  [1] 2 1 2 1 1 2 1 2 1 2 1 1 1 2 1 2 2 1 2 2 1 2 2 2 1 1 2 1
#&gt; [29] 2 1</code></pre>
<div id="exercise-mc" class="section level2 infobox" number="2.1">
<h2>
<span class="header-section-number">2.1</span> Exercise MC<a class="anchor" aria-label="anchor" href="#exercise-mc"><i class="fas fa-link"></i></a>
</h2>
<blockquote>
<p>Can you extend this example to a three-state model?</p>
</blockquote>
<div class="inline-figure"><img src="05-markov-chains_files/figure-html/unnamed-chunk-4-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>Note, the diagram (intentionally) misses out the self-transitions. You should be able to infer this because the probabilities given would otherwise not add up to one!</p>
<button class="button">
<a href="mc-solution.html#mc-solution">Show Solution</a>
</button>
</div>

</div>
  <div class="chapter-nav">
<div class="prev"><a href="simulating-random-numbers.html"><span class="header-section-number">1</span> Simulating random numbers</a></div>
<div class="next"><a href="mc-solution.html">Solution: 3 state Markov Chain</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#markov-chains"><span class="header-section-number">2</span> Markov Chains</a></li>
<li><a class="nav-link" href="#exercise-mc"><span class="header-section-number">2.1</span> Exercise MC</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/anasrana/ems-practicals/blob/master/05-markov-chains.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/anasrana/ems-practicals/edit/master/05-markov-chains.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Essentials of Mathematics and Statistics</strong>" was written by Anas A Rana. It was last built on 2024-06-11.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
