<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 12 QQ Plot - How To Use And Interpret | Essentials of Mathematics and Statistics</title>
<meta name="author" content="Anas A Rana">
<meta name="description" content="In this practical we will go through practical applications of quantile quantile plots (QQ plots) and look at interpreting results. We went through the most common way they are used to check for...">
<meta name="generator" content="bookdown 0.40 with bs4_book()">
<meta property="og:title" content="Chapter 12 QQ Plot - How To Use And Interpret | Essentials of Mathematics and Statistics">
<meta property="og:type" content="book">
<meta property="og:description" content="In this practical we will go through practical applications of quantile quantile plots (QQ plots) and look at interpreting results. We went through the most common way they are used to check for...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 12 QQ Plot - How To Use And Interpret | Essentials of Mathematics and Statistics">
<meta name="twitter:description" content="In this practical we will go through practical applications of quantile quantile plots (QQ plots) and look at interpreting results. We went through the most common way they are used to check for...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><link href="libs/Manrope-0.4.9/font.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Fira%20Code:wght@100&amp;display=swap" rel="stylesheet">
<link href="libs/Spectral-0.4.9/font.css" rel="stylesheet">
<script src="libs/bs3compat-0.8.0/transition.js"></script><script src="libs/bs3compat-0.8.0/tabs.js"></script><script src="libs/bs3compat-0.8.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Essentials of Mathematics and Statistics</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Introduction to the Practical</a></li>
<li class="book-part">Probability in R</li>
<li><a class="" href="simulating-random-numbers.html"><span class="header-section-number">1</span> Simulating random numbers</a></li>
<li><a class="" href="markov-chains.html"><span class="header-section-number">2</span> Markov Chains</a></li>
<li><a class="" href="a-monopoly-simulation.html"><span class="header-section-number">3</span> A Monopoly simulation</a></li>
<li><a class="" href="monte-carlo-methods.html"><span class="header-section-number">4</span> Monte Carlo Methods</a></li>
<li><a class="" href="maximum-likelihood.html"><span class="header-section-number">5</span> Maximum Likelihood</a></li>
<li><a class="" href="confidence-intervals.html"><span class="header-section-number">6</span> Confidence Intervals</a></li>
<li><a class="" href="computational-testing-techniques.html"><span class="header-section-number">7</span> Computational Testing Techniques</a></li>
<li class="book-part">Statistical Modelling</li>
<li><a class="" href="representing-data-in-r.html"><span class="header-section-number">8</span> Representing Data in R</a></li>
<li><a class="" href="principal-component-analysis.html"><span class="header-section-number">9</span> Principal component analysis</a></li>
<li><a class="" href="linear-regression.html"><span class="header-section-number">10</span> Linear regression</a></li>
<li><a class="" href="multiple-regression.html"><span class="header-section-number">11</span> Multiple regression</a></li>
<li><a class="active" href="qq-plot.html"><span class="header-section-number">12</span> QQ Plot - How To Use And Interpret</a></li>
<li><a class="" href="generalised-linear-models.html"><span class="header-section-number">13</span> Generalised Linear Models</a></li>
<li class="book-part">Solutions</li>
<li><a class="" href="simSol.html"><span class="header-section-number">A</span> Solution: Simulations</a></li>
<li><a class="" href="mc-solution.html"><span class="header-section-number">B</span> Solution: Three state Markov Chain</a></li>
<li><a class="" href="monopolySol.html"><span class="header-section-number">C</span> Solution: Monopoly</a></li>
<li><a class="" href="solution-monte-carlo.html"><span class="header-section-number">D</span> Solution: Monte Carlo</a></li>
<li><a class="" href="sol-mle.html"><span class="header-section-number">E</span> Solution: Model Answers: MLE</a></li>
<li><a class="" href="sol-ex-CI.html"><span class="header-section-number">F</span> Solution: Confidence Interval</a></li>
<li><a class="" href="solution-computational-testing.html"><span class="header-section-number">G</span> Solution: Computational Testing</a></li>
<li><a class="" href="representing_data-sol.html"><span class="header-section-number">H</span> Solution: Representing Data</a></li>
<li><a class="" href="solution-linear-regression-and-correlation.html"><span class="header-section-number">I</span> Solution: Linear regression and Correlation</a></li>
<li class="book-part">APPENDIX</li>
<li><a class="" href="start.html">Getting started in R and Rstudio</a></li>
<li><a class="" href="data-sets.html">Data sets</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/anasrana/ems-practicals">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="qq-plot" class="section level1" number="12">
<h1>
<span class="header-section-number">12</span> QQ Plot - How To Use And Interpret<a class="anchor" aria-label="anchor" href="#qq-plot"><i class="fas fa-link"></i></a>
</h1>
<p>In this practical we will go through practical applications of quantile quantile plots (QQ plots) and look at interpreting results. We went through the most common way they are used to check for normality. You can of course use them to compare observed data to any distribution. During this exercise we will use as example data randomly generated data and a the <code>mtcars</code> data-set built into R.</p>
<div id="introduction-and-simulation" class="section level2" number="12.1">
<h2>
<span class="header-section-number">12.1</span> Introduction and Simulation<a class="anchor" aria-label="anchor" href="#introduction-and-simulation"><i class="fas fa-link"></i></a>
</h2>
<p>Let us go through creating a QQ plot from basic principles, this will give you a good understanding of what happens in the background when you use the <code>qqplot</code> functions in R. You are unlikely to do this yourself in the future but it is good to know what is happening and understand the principles you are applying.</p>
<p>We will make a start by generating some random data sampled from a normal distribution <span class="math inline">\(\operatorname{N}(\mu = 5, \sigma^2 = 4)\)</span>.</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb251-1"><a href="qq-plot.html#cb251-1"></a><span class="co"># Random seed, there is no significance to the number used</span></span>
<span id="cb251-2"><a href="qq-plot.html#cb251-2"></a><span class="fu">set.seed</span>(<span class="dv">1214</span>)</span>
<span id="cb251-3"><a href="qq-plot.html#cb251-3"></a><span class="co"># create random number sampled from a normal distribution</span></span>
<span id="cb251-4"><a href="qq-plot.html#cb251-4"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">2</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb251-5"><a href="qq-plot.html#cb251-5"></a></span>
<span id="cb251-6"><a href="qq-plot.html#cb251-6"></a><span class="fu">print</span>(x)</span></code></pre></div>
<pre class="bg-info"><code>#&gt;  [1]  3.0199947  1.7430854  3.8219702  1.2638861 -0.9820494
#&gt;  [6] -1.6086784  2.1157220 -0.4646442 -1.2996165  3.7570844
#&gt; [11]  0.8184567  2.1577627  1.6635102  2.6436570 -0.4730233
#&gt; [16]  5.1968979  4.5040566  0.6371819  0.5883411  0.0900340</code></pre>
<p>The first step is to sort the data, and then can create quantiles. We can create naïve quantiles based on this data first. This is done by ranking the data and dividing by the length of the data. This is a simple way to create quantiles but it is not centered. We will also create theoretical quantiles based on the standard normal distribution.</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb253-1"><a href="qq-plot.html#cb253-1"></a>x_sort <span class="ot">&lt;-</span> <span class="fu">sort</span>(x)</span>
<span id="cb253-2"><a href="qq-plot.html#cb253-2"></a></span>
<span id="cb253-3"><a href="qq-plot.html#cb253-3"></a><span class="fu">rank</span>(x_sort) <span class="sc">/</span> <span class="fu">length</span>(x_sort)</span></code></pre></div>
<pre class="bg-info"><code>#&gt;  [1] 0.05 0.10 0.15 0.20 0.25 0.30 0.35 0.40 0.45 0.50 0.55
#&gt; [12] 0.60 0.65 0.70 0.75 0.80 0.85 0.90 0.95 1.00</code></pre>
<p>When we create theoretical quantiles we want to center them. You can check this yourself try <code>qnorm(0)</code> and <code>qnorm(1)</code>. Instead we adjust the ranks by <span class="math inline">\(1/2\)</span> to get a centered bins. There is an inbuilt function in R that also performs this adjustment, <code>ppoints</code>. <em>Remember to check how it works using <code><a href="https://rdrr.io/r/stats/ppoints.html">?ppoints</a></code></em></p>
<div class="sourceCode" id="cb255"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb255-1"><a href="qq-plot.html#cb255-1"></a><span class="co"># Emperical quantiles</span></span>
<span id="cb255-2"><a href="qq-plot.html#cb255-2"></a>eq <span class="ot">&lt;-</span> (<span class="fu">rank</span>(x_sort) <span class="sc">-</span> <span class="fl">0.5</span>) <span class="sc">/</span> <span class="fu">length</span>(x_sort)</span>
<span id="cb255-3"><a href="qq-plot.html#cb255-3"></a></span>
<span id="cb255-4"><a href="qq-plot.html#cb255-4"></a><span class="co"># Emperical quantiles using ppoints</span></span>
<span id="cb255-5"><a href="qq-plot.html#cb255-5"></a>eq_p <span class="ot">&lt;-</span> <span class="fu">ppoints</span>(<span class="fu">length</span>(x_sort))</span>
<span id="cb255-6"><a href="qq-plot.html#cb255-6"></a></span>
<span id="cb255-7"><a href="qq-plot.html#cb255-7"></a><span class="co"># Check if the two ways produce an identical vector</span></span>
<span id="cb255-8"><a href="qq-plot.html#cb255-8"></a><span class="fu">print</span>(<span class="fu">identical</span>(eq, eq_p))</span></code></pre></div>
<pre class="bg-info"><code>#&gt; [1] TRUE</code></pre>
<div class="sourceCode" id="cb257"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb257-1"><a href="qq-plot.html#cb257-1"></a><span class="co"># Print the values</span></span>
<span id="cb257-2"><a href="qq-plot.html#cb257-2"></a><span class="fu">print</span>(eq)</span></code></pre></div>
<pre class="bg-info"><code>#&gt;  [1] 0.025 0.075 0.125 0.175 0.225 0.275 0.325 0.375 0.425
#&gt; [10] 0.475 0.525 0.575 0.625 0.675 0.725 0.775 0.825 0.875
#&gt; [19] 0.925 0.975</code></pre>
<p>You can see that the first quantile 0.05 becomes 0.025. We will use the sample mean and sample standard deviation. We also want to project our data on the standard normal distribution as that is how a QQ plot is generated. It is just a simple transformation and we can plot the two values to convince ourselves that is the case.</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb259-1"><a href="qq-plot.html#cb259-1"></a><span class="co"># Theoretical quantiles</span></span>
<span id="cb259-2"><a href="qq-plot.html#cb259-2"></a>tq <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(eq, <span class="fu">mean</span>(x_sort), <span class="fu">sd</span>(x_sort))</span>
<span id="cb259-3"><a href="qq-plot.html#cb259-3"></a></span>
<span id="cb259-4"><a href="qq-plot.html#cb259-4"></a><span class="co"># Quantiles for Standard noraml</span></span>
<span id="cb259-5"><a href="qq-plot.html#cb259-5"></a>tq_sn <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(eq, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb259-6"><a href="qq-plot.html#cb259-6"></a></span>
<span id="cb259-7"><a href="qq-plot.html#cb259-7"></a><span class="co"># Plot the two values</span></span>
<span id="cb259-8"><a href="qq-plot.html#cb259-8"></a><span class="co"># You will see that it is simple transformation. All values are on straight line</span></span>
<span id="cb259-9"><a href="qq-plot.html#cb259-9"></a><span class="fu">plot</span>(tq, tq_sn)</span></code></pre></div>
<div class="inline-figure"><img src="QQ-plot_files/figure-html/unnamed-chunk-4-1.png" width="95%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb260"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb260-1"><a href="qq-plot.html#cb260-1"></a><span class="fu">print</span>(tq)</span></code></pre></div>
<pre class="bg-info"><code>#&gt;  [1] -2.38629750 -1.36506828 -0.79761487 -0.37423528
#&gt;  [5] -0.02264695  0.28671456  0.56927742  0.83442492
#&gt;  [9]  1.08858000  1.33663381  1.58272910  1.83078291
#&gt; [13]  2.08493799  2.35008548  2.63264834  2.94200986
#&gt; [17]  3.29359818  3.71697778  4.28443118  5.30566040</code></pre>
<p>The next thing we need is to create is the reference line to assess if the empirical quantiles correspond to the theoretical ones from the distribution we are comparing to. There are two lines we could consider, it is either the naïve line<span class="math inline">\(y = mean + s \times x\)</span>, where <span class="math inline">\(s\)</span> is the sample standard deviation and the mean is the sample mean. The other option is a robust line which works better especially if there is deviation from the normal in the sample, here we replace the mean with the median and the standard deviation with the interquartile range.
a QQ
Let us put everything together and create a plot with both the naïve and robust lines.</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb262-1"><a href="qq-plot.html#cb262-1"></a><span class="co"># library for plotting</span></span>
<span id="cb262-2"><a href="qq-plot.html#cb262-2"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb262-3"><a href="qq-plot.html#cb262-3"></a></span>
<span id="cb262-4"><a href="qq-plot.html#cb262-4"></a><span class="co"># create a data.frame with the vectors we have already created</span></span>
<span id="cb262-5"><a href="qq-plot.html#cb262-5"></a>qq_df <span class="ot">&lt;-</span></span>
<span id="cb262-6"><a href="qq-plot.html#cb262-6"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb262-7"><a href="qq-plot.html#cb262-7"></a>    <span class="at">x =</span> x_sort,</span>
<span id="cb262-8"><a href="qq-plot.html#cb262-8"></a>    <span class="at">eq =</span> eq,</span>
<span id="cb262-9"><a href="qq-plot.html#cb262-9"></a>    <span class="at">tq =</span> tq_sn)</span>
<span id="cb262-10"><a href="qq-plot.html#cb262-10"></a></span>
<span id="cb262-11"><a href="qq-plot.html#cb262-11"></a><span class="co"># Add the naïve line</span></span>
<span id="cb262-12"><a href="qq-plot.html#cb262-12"></a>qq_df<span class="sc">$</span>naive <span class="ot">&lt;-</span> <span class="fu">mean</span>(x_sort) <span class="sc">+</span> <span class="fu">sd</span>(x_sort) <span class="sc">*</span> tq_sn</span>
<span id="cb262-13"><a href="qq-plot.html#cb262-13"></a></span>
<span id="cb262-14"><a href="qq-plot.html#cb262-14"></a><span class="co"># Add the robust line into the data.frame</span></span>
<span id="cb262-15"><a href="qq-plot.html#cb262-15"></a>qq_df<span class="sc">$</span>qq_line <span class="ot">&lt;-</span> <span class="fu">median</span>(x_sort) <span class="sc">+</span> <span class="fu">IQR</span>(x_sort) <span class="sc">*</span> tq_sn</span>
<span id="cb262-16"><a href="qq-plot.html#cb262-16"></a></span>
<span id="cb262-17"><a href="qq-plot.html#cb262-17"></a><span class="co"># When using ggplot you start with the basic framework declaring the data</span></span>
<span id="cb262-18"><a href="qq-plot.html#cb262-18"></a><span class="co"># We declare the data and aesthetics of the plot that are shared</span></span>
<span id="cb262-19"><a href="qq-plot.html#cb262-19"></a><span class="co"># We end with a + to indicated there is more to come</span></span>
<span id="cb262-20"><a href="qq-plot.html#cb262-20"></a><span class="fu">ggplot</span>(<span class="at">data =</span> qq_df, <span class="fu">aes</span>(<span class="at">x =</span> tq)) <span class="sc">+</span></span>
<span id="cb262-21"><a href="qq-plot.html#cb262-21"></a>  <span class="co"># We create points for the observed data with size =3</span></span>
<span id="cb262-22"><a href="qq-plot.html#cb262-22"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> x_sort), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb262-23"><a href="qq-plot.html#cb262-23"></a>  <span class="co"># We create the naïve line in blue</span></span>
<span id="cb262-24"><a href="qq-plot.html#cb262-24"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> naive), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb262-25"><a href="qq-plot.html#cb262-25"></a>  <span class="co"># We create the robust line in red</span></span>
<span id="cb262-26"><a href="qq-plot.html#cb262-26"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> qq_line), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb262-27"><a href="qq-plot.html#cb262-27"></a>  <span class="co"># Change the plot theme to something easier to see</span></span>
<span id="cb262-28"><a href="qq-plot.html#cb262-28"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb262-29"><a href="qq-plot.html#cb262-29"></a>  <span class="fu">labs</span>(</span>
<span id="cb262-30"><a href="qq-plot.html#cb262-30"></a>    <span class="at">x =</span> <span class="st">"Theoretical Quantiles"</span>,</span>
<span id="cb262-31"><a href="qq-plot.html#cb262-31"></a>    <span class="at">y =</span> <span class="st">"Sample Quantiles"</span></span>
<span id="cb262-32"><a href="qq-plot.html#cb262-32"></a>  )</span></code></pre></div>
<pre><code>#&gt; Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
#&gt; ℹ Please use `linewidth` instead.
#&gt; This warning is displayed once every 8 hours.
#&gt; Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.</code></pre>
<div class="inline-figure"><img src="QQ-plot_files/figure-html/unnamed-chunk-5-1.png" width="95%" style="display: block; margin: auto;"></div>
<p>You can see that there is a small difference between the two lines but it can be larger depending on the data.</p>
</div>
<div id="plotting-qq-plots-in-r" class="section level2" number="12.2">
<h2>
<span class="header-section-number">12.2</span> Plotting QQ Plots in R<a class="anchor" aria-label="anchor" href="#plotting-qq-plots-in-r"><i class="fas fa-link"></i></a>
</h2>
<p>Everything above was just to gain an understanding of what goes into a QQ plot. Of course you would not go through this whole process every time you want to create such a plot. Instead you would use inbuilt functions in R.</p>
<p>Let’s first recreate the plots based on the above data to check it’s working and ensure we have performed the correct steps. We will use both base R plots and <code>ggplot</code></p>
<p>First we use <code>ggplot</code> and you will note that instead of providing the <code>x</code> or <code>y</code> aesthetics we provide the the <code>sample</code> aesthetics. <em>As usual to learn more about this use <code>?stat_qq</code> and <code>?stat_qq_line</code> to learn more about these.</em></p>
<div class="sourceCode" id="cb264"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb264-1"><a href="qq-plot.html#cb264-1"></a><span class="co"># ggplot providing the data.frame variable and the sample</span></span>
<span id="cb264-2"><a href="qq-plot.html#cb264-2"></a><span class="fu">ggplot</span>(<span class="at">data =</span> qq_df, <span class="fu">aes</span>(<span class="at">sample =</span> x_sort)) <span class="sc">+</span></span>
<span id="cb264-3"><a href="qq-plot.html#cb264-3"></a>  <span class="co"># creating the points in the sample</span></span>
<span id="cb264-4"><a href="qq-plot.html#cb264-4"></a>  <span class="fu">stat_qq</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb264-5"><a href="qq-plot.html#cb264-5"></a>  <span class="co"># Create the line for comparison</span></span>
<span id="cb264-6"><a href="qq-plot.html#cb264-6"></a>  <span class="fu">stat_qq_line</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb264-7"><a href="qq-plot.html#cb264-7"></a>  <span class="co"># Choosing a simpler theme</span></span>
<span id="cb264-8"><a href="qq-plot.html#cb264-8"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<div class="inline-figure"><img src="QQ-plot_files/figure-html/unnamed-chunk-6-1.png" width="95%" style="display: block; margin: auto;"></div>
<p>You can also use base R to create these plots using the functions <code>qqnorm</code> and <code>qqline</code>. Check the help functions for these before making use of them.</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb265-1"><a href="qq-plot.html#cb265-1"></a><span class="co"># Create a plot of sample quantiles and theoretical quantiles</span></span>
<span id="cb265-2"><a href="qq-plot.html#cb265-2"></a><span class="fu">qqnorm</span>(x_sort, <span class="at">frame =</span> <span class="cn">FALSE</span>)</span>
<span id="cb265-3"><a href="qq-plot.html#cb265-3"></a><span class="co"># Create the reference line for comparison in blue linewidth = 2</span></span>
<span id="cb265-4"><a href="qq-plot.html#cb265-4"></a><span class="fu">qqline</span>(x_sort, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="inline-figure"><img src="QQ-plot_files/figure-html/unnamed-chunk-7-1.png" width="95%" style="display: block; margin: auto;"></div>
<p>We can see that all plots we have created above yield the same results. Both work but <code>ggplot</code> has more versatility. Let us look at that using the <code>mtcars</code> data.</p>
<p>This dataset contains a variety of information about cars. We will specifically make use of the miles per gallon (<code>mpg</code>) and the number of cylinders (<code>cyl</code>). One data structure we will make use of here is <code>factors</code>. (See <a href="https://swcarpentry.github.io/r-novice-inflammation/12-supp-factors/index.html">here</a> for brief description and some exercies on factors.)</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb266-1"><a href="qq-plot.html#cb266-1"></a><span class="co"># convert the cyl varibale in the data into factors</span></span>
<span id="cb266-2"><a href="qq-plot.html#cb266-2"></a>mtcars<span class="sc">$</span>cyl <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(mtcars<span class="sc">$</span>cyl)</span>
<span id="cb266-3"><a href="qq-plot.html#cb266-3"></a></span>
<span id="cb266-4"><a href="qq-plot.html#cb266-4"></a><span class="co"># Look at the top 6 rows of the data.frame</span></span>
<span id="cb266-5"><a href="qq-plot.html#cb266-5"></a><span class="fu">head</span>(mtcars)</span></code></pre></div>
<pre class="bg-info"><code>#&gt;                    mpg cyl disp  hp drat    wt  qsec vs am
#&gt; Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1
#&gt; Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1
#&gt; Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1
#&gt; Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0
#&gt; Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0
#&gt; Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0
#&gt;                   gear carb
#&gt; Mazda RX4            4    4
#&gt; Mazda RX4 Wag        4    4
#&gt; Datsun 710           4    1
#&gt; Hornet 4 Drive       3    1
#&gt; Hornet Sportabout    3    2
#&gt; Valiant              3    1</code></pre>
<p>We can now use this slightly changed <code>data.frame</code> to create QQ plots in one go subsetting for the number of cylinders cars have.</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb268-1"><a href="qq-plot.html#cb268-1"></a><span class="co"># We use as the data the slightly modified mtcars data.frame</span></span>
<span id="cb268-2"><a href="qq-plot.html#cb268-2"></a><span class="co"># As asthetics we mpg as the sample and we want to colour code for cyclinders</span></span>
<span id="cb268-3"><a href="qq-plot.html#cb268-3"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="fu">aes</span>(<span class="at">sample =</span> mpg, <span class="at">color =</span> cyl)) <span class="sc">+</span></span>
<span id="cb268-4"><a href="qq-plot.html#cb268-4"></a>  <span class="co"># We create the points first</span></span>
<span id="cb268-5"><a href="qq-plot.html#cb268-5"></a>  <span class="fu">stat_qq</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb268-6"><a href="qq-plot.html#cb268-6"></a>  <span class="co"># We now add the reference lines</span></span>
<span id="cb268-7"><a href="qq-plot.html#cb268-7"></a>  <span class="fu">stat_qq_line</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb268-8"><a href="qq-plot.html#cb268-8"></a>  <span class="co"># We choose a theme that is easier to read</span></span>
<span id="cb268-9"><a href="qq-plot.html#cb268-9"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<div class="inline-figure"><img src="QQ-plot_files/figure-html/unnamed-chunk-9-1.png" width="95%" style="display: block; margin: auto;"></div>
<p>You can see how useful this approach can be be and managed to create a lot of information in a few lines of code.</p>
</div>
<div id="interpreting-qq-plots" class="section level2" number="12.3">
<h2>
<span class="header-section-number">12.3</span> Interpreting QQ Plots<a class="anchor" aria-label="anchor" href="#interpreting-qq-plots"><i class="fas fa-link"></i></a>
</h2>
<p>The main reason we use QQ plots is to assess if our data can be from a specific distribution. Usually we will perform this test to check for normality. This can be important if we perform a statistical test that makes the normality assumption. Since it is only a visual test it is subjective.</p>
<p>In QQ plot we are putting our data in quantiles and answering the questions: how similar are these sample quantiles to the theoretical values from a probability distribution. We put each data point we observe into its own quantile and compare them to a theoretical probability distribution.</p>
<p>Obviously, because we are looking at subjective visual comparison it is important to understand what these comparisons mean. To do that we will first create a few functions to make it easier to go from random sample to plot.</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb269-1"><a href="qq-plot.html#cb269-1"></a><span class="co"># function to plot histogram and distribution for comparison</span></span>
<span id="cb269-2"><a href="qq-plot.html#cb269-2"></a>hist_comp  <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">n_breaks =</span> <span class="dv">30</span>, title, xs, norm_dens) {</span>
<span id="cb269-3"><a href="qq-plot.html#cb269-3"></a>  <span class="fu">hist</span>(x, <span class="at">breaks =</span> n_breaks, <span class="at">xlab =</span> <span class="st">"Sample Value"</span>, <span class="at">ylab =</span> <span class="st">""</span>,</span>
<span id="cb269-4"><a href="qq-plot.html#cb269-4"></a>       <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> title, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.45</span>))</span>
<span id="cb269-5"><a href="qq-plot.html#cb269-5"></a>  <span class="fu">lines</span>(xs, norm_dens, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb269-6"><a href="qq-plot.html#cb269-6"></a></span>
<span id="cb269-7"><a href="qq-plot.html#cb269-7"></a>}</span>
<span id="cb269-8"><a href="qq-plot.html#cb269-8"></a></span>
<span id="cb269-9"><a href="qq-plot.html#cb269-9"></a><span class="co"># function to create QQ scatter plot and reference line</span></span>
<span id="cb269-10"><a href="qq-plot.html#cb269-10"></a>qq_comp <span class="ot">&lt;-</span> <span class="cf">function</span>(gaussian_rv) {</span>
<span id="cb269-11"><a href="qq-plot.html#cb269-11"></a>  <span class="fu">qqnorm</span>(gaussian_rv)</span>
<span id="cb269-12"><a href="qq-plot.html#cb269-12"></a>  <span class="fu">qqline</span>(gaussian_rv, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb269-13"><a href="qq-plot.html#cb269-13"></a>}</span></code></pre></div>
</div>
<div id="standard-normal" class="section level2" number="12.4">
<h2>
<span class="header-section-number">12.4</span> Standard Normal<a class="anchor" aria-label="anchor" href="#standard-normal"><i class="fas fa-link"></i></a>
</h2>
<p>Now we can start comparing, we will start with the simplest comparison. Here we will sample from a normal distribution with <span class="math inline">\(\operatorname{N}(\mu = 0, \sigma^2 = 1)\)</span>.</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb270-1"><a href="qq-plot.html#cb270-1"></a><span class="co"># Create two plots next to each other one row and two columns</span></span>
<span id="cb270-2"><a href="qq-plot.html#cb270-2"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb270-3"><a href="qq-plot.html#cb270-3"></a></span>
<span id="cb270-4"><a href="qq-plot.html#cb270-4"></a><span class="co"># Sample data</span></span>
<span id="cb270-5"><a href="qq-plot.html#cb270-5"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb270-6"><a href="qq-plot.html#cb270-6"></a><span class="fu">set.seed</span>(<span class="dv">1234324</span>) <span class="co"># choosing reproducible seed for random number</span></span>
<span id="cb270-7"><a href="qq-plot.html#cb270-7"></a>data_sample <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb270-8"><a href="qq-plot.html#cb270-8"></a></span>
<span id="cb270-9"><a href="qq-plot.html#cb270-9"></a><span class="co"># normal density</span></span>
<span id="cb270-10"><a href="qq-plot.html#cb270-10"></a><span class="co"># xs are x-values for the distribution</span></span>
<span id="cb270-11"><a href="qq-plot.html#cb270-11"></a>xs <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="fl">0.01</span>)</span>
<span id="cb270-12"><a href="qq-plot.html#cb270-12"></a>norm_dens <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(xs)</span>
<span id="cb270-13"><a href="qq-plot.html#cb270-13"></a></span>
<span id="cb270-14"><a href="qq-plot.html#cb270-14"></a><span class="fu">hist_comp</span>(data_sample, <span class="at">title =</span> <span class="st">"Gaussian Distribution"</span>,</span>
<span id="cb270-15"><a href="qq-plot.html#cb270-15"></a>         <span class="at">xs =</span> xs, <span class="at">norm_dens =</span> norm_dens)</span>
<span id="cb270-16"><a href="qq-plot.html#cb270-16"></a></span>
<span id="cb270-17"><a href="qq-plot.html#cb270-17"></a><span class="fu">qq_comp</span>(data_sample)</span></code></pre></div>
<div class="inline-figure"><img src="QQ-plot_files/figure-html/unnamed-chunk-11-1.png" width="95%" style="display: block; margin: auto;"></div>
<p>Here we can see on the left the theoretical Gaussian distribution as the read curve. The histogram shows the sample with n = 10000. The same data is represented on the right which is a QQ plot. The normal distribution is along the diagonal blue line. We can see that this data lies mostly along the diagonal so matches the standard normal. There is some minor deviation on the edges of the distribution. Here there are minor deviation on the tails but only a handful of points out of the large sample.</p>
</div>
<div id="skewed-data" class="section level2" number="12.5">
<h2>
<span class="header-section-number">12.5</span> Skewed data<a class="anchor" aria-label="anchor" href="#skewed-data"><i class="fas fa-link"></i></a>
</h2>
<p>Now we will look at data that is skewed in either directions, which we can see on the histogram and what that looks like on the QQ plot. We will make use of filtering the vector of data using the square brackets. If we have a vector <code>vec_a</code> we can subset (or filter) all values smaller than zero by using <code>vec_b &lt;- vec_a[vec_a &lt; 0]</code>. This new vector <code>vec_b</code> contains all entires in <code>vec_a</code> that are smaller than 0.</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb271-1"><a href="qq-plot.html#cb271-1"></a><span class="co"># Skewed left more samples to the left of standard normal</span></span>
<span id="cb271-2"><a href="qq-plot.html#cb271-2"></a><span class="co"># To create this data we will add more samples to the left of the mean</span></span>
<span id="cb271-3"><a href="qq-plot.html#cb271-3"></a><span class="co"># artificially using the same data as above</span></span>
<span id="cb271-4"><a href="qq-plot.html#cb271-4"></a><span class="fu">set.seed</span>(<span class="dv">1234234</span>) <span class="co">#set a random seed</span></span>
<span id="cb271-5"><a href="qq-plot.html#cb271-5"></a><span class="co"># we create a vector which contains the new data</span></span>
<span id="cb271-6"><a href="qq-plot.html#cb271-6"></a>new_skew_left <span class="ot">&lt;-</span> data_sample[data_sample <span class="sc">&lt;</span> <span class="dv">0</span>] <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb271-7"><a href="qq-plot.html#cb271-7"></a>nor_skew_left <span class="ot">&lt;-</span> <span class="fu">c</span>(new_skew_left, data_sample)</span>
<span id="cb271-8"><a href="qq-plot.html#cb271-8"></a></span>
<span id="cb271-9"><a href="qq-plot.html#cb271-9"></a><span class="co"># Create new plots</span></span>
<span id="cb271-10"><a href="qq-plot.html#cb271-10"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb271-11"><a href="qq-plot.html#cb271-11"></a><span class="fu">hist_comp</span>(nor_skew_left, <span class="at">title =</span> <span class="st">"Skewed Left"</span>, <span class="at">xs =</span> xs,</span>
<span id="cb271-12"><a href="qq-plot.html#cb271-12"></a>          <span class="at">norm_dens =</span> norm_dens)</span>
<span id="cb271-13"><a href="qq-plot.html#cb271-13"></a><span class="fu">qq_comp</span>(nor_skew_left)</span></code></pre></div>
<div class="inline-figure"><img src="QQ-plot_files/figure-html/unnamed-chunk-12-1.png" width="95%" style="display: block; margin: auto;"></div>
<p>If the data is left skewed as in this case, you can see that the histogram is shifted to the left compared to the standard normal distribution. You can see a proportion of the data on the left tail of the distribution. Now looking at the corresponding QQ plot we can see the first two quantiles are blow the theoretical (diagonal) line. The points above 0 are close to the diagonal but below 0 the points deviate from the diagonal. If you see such a QQ plot, the interpretation is that the data is left skewed.</p>
<blockquote>
<p><strong>Q.</strong> Now try to create data skewed to the right and interpret the plots you create.</p>
</blockquote>
<details><summary>
Only expand once you have made an attempt!
</summary><div class="sourceCode" id="cb272"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb272-1"><a href="qq-plot.html#cb272-1"></a><span class="co"># Skewed right more samples to the right of standard normal</span></span>
<span id="cb272-2"><a href="qq-plot.html#cb272-2"></a><span class="co"># To create this data we will add more samples to the right of the mean</span></span>
<span id="cb272-3"><a href="qq-plot.html#cb272-3"></a><span class="co"># artificially using the same data as above</span></span>
<span id="cb272-4"><a href="qq-plot.html#cb272-4"></a><span class="fu">set.seed</span>(<span class="dv">1234234</span>) <span class="co">#set a random seed</span></span>
<span id="cb272-5"><a href="qq-plot.html#cb272-5"></a><span class="co"># we create a vector which contains the new data</span></span>
<span id="cb272-6"><a href="qq-plot.html#cb272-6"></a>new_skew_right <span class="ot">&lt;-</span> data_sample[data_sample <span class="sc">&gt;</span> <span class="dv">0</span>] <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb272-7"><a href="qq-plot.html#cb272-7"></a>nor_skew_right <span class="ot">&lt;-</span> <span class="fu">c</span>(new_skew_right, data_sample)</span>
<span id="cb272-8"><a href="qq-plot.html#cb272-8"></a></span>
<span id="cb272-9"><a href="qq-plot.html#cb272-9"></a><span class="co">#Create new plots</span></span>
<span id="cb272-10"><a href="qq-plot.html#cb272-10"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb272-11"><a href="qq-plot.html#cb272-11"></a><span class="fu">hist_comp</span>(nor_skew_right, <span class="at">title =</span> <span class="st">"Skewed Right"</span>, <span class="at">xs =</span> xs,</span>
<span id="cb272-12"><a href="qq-plot.html#cb272-12"></a>          <span class="at">norm_dens =</span> norm_dens)</span>
<span id="cb272-13"><a href="qq-plot.html#cb272-13"></a><span class="fu">qq_comp</span>(nor_skew_right)</span></code></pre></div>
<div class="inline-figure"><img src="QQ-plot_files/figure-html/unnamed-chunk-13-1.png" width="95%" style="display: block; margin: auto;"></div>
Here we are looking at data that is skewed to the right of the standard normal. The histogram is shifted to the right of the standard normal (red line). On the QQ plot we now see a deviation from the diagonal for values larger than 0. Seeing such a QQ plot means you are looking right skewed data.
</details>
</div>
<div id="symmetric-tails" class="section level2" number="12.6">
<h2>
<span class="header-section-number">12.6</span> Symmetric Tails<a class="anchor" aria-label="anchor" href="#symmetric-tails"><i class="fas fa-link"></i></a>
</h2>
<p>We can also have tails which are symmetric on both sides. We distinguish between fat tailed and thin tailed distributions. We will again create such data and look at how we can identify them in a QQ plot. We wills tart with at fat tailed example.</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb273-1"><a href="qq-plot.html#cb273-1"></a><span class="co"># To create fat tailed data</span></span>
<span id="cb273-2"><a href="qq-plot.html#cb273-2"></a>nor_fat <span class="ot">&lt;-</span> <span class="fu">c</span>(data_sample <span class="sc">*</span> <span class="dv">3</span>, data_sample)</span>
<span id="cb273-3"><a href="qq-plot.html#cb273-3"></a></span>
<span id="cb273-4"><a href="qq-plot.html#cb273-4"></a><span class="co"># Create plot</span></span>
<span id="cb273-5"><a href="qq-plot.html#cb273-5"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb273-6"><a href="qq-plot.html#cb273-6"></a><span class="fu">hist_comp</span>(nor_fat, <span class="at">title =</span> <span class="st">"Fat Tails"</span>, <span class="at">xs =</span> xs, <span class="at">norm_dens =</span> norm_dens)</span>
<span id="cb273-7"><a href="qq-plot.html#cb273-7"></a><span class="fu">qq_comp</span>(nor_fat)</span></code></pre></div>
<div class="inline-figure"><img src="QQ-plot_files/figure-html/unnamed-chunk-14-1.png" width="95%" style="display: block; margin: auto;"></div>
<p>Here we can see the histogram there is more data located both to the right and left of the standard normal distribution drawn as a red line. When we look at the QQ plot we see that the first quantiles are smaller than the corresponding theoretical values. For larger quantiles the values are larger than the theoretical values.</p>
<p>We can now look at thin tailed, the easiest way to simulate this is by using a normal distribution with variance smaller than 1.</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb274-1"><a href="qq-plot.html#cb274-1"></a><span class="co"># Create thin tailed data</span></span>
<span id="cb274-2"><a href="qq-plot.html#cb274-2"></a><span class="fu">set.seed</span>(<span class="dv">1112</span>) <span class="co"># set a random seed</span></span>
<span id="cb274-3"><a href="qq-plot.html#cb274-3"></a><span class="co"># we simulate new data with n as before but different variance</span></span>
<span id="cb274-4"><a href="qq-plot.html#cb274-4"></a>norm_thin <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="fl">0.5</span>)</span>
<span id="cb274-5"><a href="qq-plot.html#cb274-5"></a></span>
<span id="cb274-6"><a href="qq-plot.html#cb274-6"></a><span class="co"># Create plots</span></span>
<span id="cb274-7"><a href="qq-plot.html#cb274-7"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb274-8"><a href="qq-plot.html#cb274-8"></a><span class="fu">hist_comp</span>(norm_thin, <span class="at">title =</span> <span class="st">"Skewed Right"</span>, <span class="at">xs =</span> xs,</span>
<span id="cb274-9"><a href="qq-plot.html#cb274-9"></a>          <span class="at">norm_dens =</span> norm_dens)</span>
<span id="cb274-10"><a href="qq-plot.html#cb274-10"></a><span class="fu">qq_comp</span>(norm_thin)</span></code></pre></div>
<div class="inline-figure"><img src="QQ-plot_files/figure-html/unnamed-chunk-15-1.png" width="95%" style="display: block; margin: auto;"></div>
<p>Here we can see that the histogram of the data indicating a distribution narrower than the standard normal distribution. Here it is a little tricker to see in the QQ plot but you should notice that the initial quartiles have values higher than the diagonal and the last quantiles have values smaller than the diagonal. This is the opposite behavior compared to the fat tailed distribution.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="multiple-regression.html"><span class="header-section-number">11</span> Multiple regression</a></div>
<div class="next"><a href="generalised-linear-models.html"><span class="header-section-number">13</span> Generalised Linear Models</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#qq-plot"><span class="header-section-number">12</span> QQ Plot - How To Use And Interpret</a></li>
<li><a class="nav-link" href="#introduction-and-simulation"><span class="header-section-number">12.1</span> Introduction and Simulation</a></li>
<li><a class="nav-link" href="#plotting-qq-plots-in-r"><span class="header-section-number">12.2</span> Plotting QQ Plots in R</a></li>
<li><a class="nav-link" href="#interpreting-qq-plots"><span class="header-section-number">12.3</span> Interpreting QQ Plots</a></li>
<li><a class="nav-link" href="#standard-normal"><span class="header-section-number">12.4</span> Standard Normal</a></li>
<li><a class="nav-link" href="#skewed-data"><span class="header-section-number">12.5</span> Skewed data</a></li>
<li><a class="nav-link" href="#symmetric-tails"><span class="header-section-number">12.6</span> Symmetric Tails</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/anasrana/ems-practicals/blob/master/QQ-plot.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/anasrana/ems-practicals/edit/master/QQ-plot.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Essentials of Mathematics and Statistics</strong>" was written by Anas A Rana. It was last built on 2024-10-07.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
