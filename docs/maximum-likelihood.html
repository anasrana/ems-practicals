<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 5 Maximum Likelihood | Essentials of Mathematics and Statistics</title>
<meta name="author" content="Anas A Rana">
<meta name="description" content="During the lectures, you saw how we could use a brute-force search of parameters to find the maximum likelihood estimate of an unknown mean for a Normal distribution given a set of data. In this...">
<meta name="generator" content="bookdown 0.40 with bs4_book()">
<meta property="og:title" content="Chapter 5 Maximum Likelihood | Essentials of Mathematics and Statistics">
<meta property="og:type" content="book">
<meta property="og:description" content="During the lectures, you saw how we could use a brute-force search of parameters to find the maximum likelihood estimate of an unknown mean for a Normal distribution given a set of data. In this...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 5 Maximum Likelihood | Essentials of Mathematics and Statistics">
<meta name="twitter:description" content="During the lectures, you saw how we could use a brute-force search of parameters to find the maximum likelihood estimate of an unknown mean for a Normal distribution given a set of data. In this...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><link href="libs/Manrope-0.4.9/font.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Fira%20Code:wght@100&amp;display=swap" rel="stylesheet">
<link href="libs/Spectral-0.4.9/font.css" rel="stylesheet">
<script src="libs/bs3compat-0.8.0/transition.js"></script><script src="libs/bs3compat-0.8.0/tabs.js"></script><script src="libs/bs3compat-0.8.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Essentials of Mathematics and Statistics</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Introduction to the Practical</a></li>
<li class="book-part">Probability in R</li>
<li><a class="" href="simulating-random-numbers.html"><span class="header-section-number">1</span> Simulating random numbers</a></li>
<li><a class="" href="markov-chains.html"><span class="header-section-number">2</span> Markov Chains</a></li>
<li><a class="" href="a-monopoly-simulation.html"><span class="header-section-number">3</span> A Monopoly simulation</a></li>
<li><a class="" href="monte-carlo-methods.html"><span class="header-section-number">4</span> Monte Carlo Methods</a></li>
<li><a class="active" href="maximum-likelihood.html"><span class="header-section-number">5</span> Maximum Likelihood</a></li>
<li><a class="" href="confidence-intervals.html"><span class="header-section-number">6</span> Confidence Intervals</a></li>
<li><a class="" href="computational-testing-techniques.html"><span class="header-section-number">7</span> Computational Testing Techniques</a></li>
<li class="book-part">Statistical Modelling</li>
<li><a class="" href="representing-data-in-r.html"><span class="header-section-number">8</span> Representing Data in R</a></li>
<li><a class="" href="principal-component-analysis.html"><span class="header-section-number">9</span> Principal component analysis</a></li>
<li><a class="" href="linear-regression.html"><span class="header-section-number">10</span> Linear regression</a></li>
<li><a class="" href="multiple-regression.html"><span class="header-section-number">11</span> Multiple regression</a></li>
<li><a class="" href="qq-plot.html"><span class="header-section-number">12</span> QQ Plot - How To Use And Interpret</a></li>
<li><a class="" href="practical-generalised-linear-models.html"><span class="header-section-number">13</span> Practical: Generalised linear models</a></li>
<li class="book-part">Solutions</li>
<li><a class="" href="simSol.html"><span class="header-section-number">A</span> Solution: Simulations</a></li>
<li><a class="" href="mc-solution.html"><span class="header-section-number">B</span> Solution: Three state Markov Chain</a></li>
<li><a class="" href="monopolySol.html"><span class="header-section-number">C</span> Solution: Monopoly</a></li>
<li><a class="" href="solution-monte-carlo.html"><span class="header-section-number">D</span> Solution: Monte Carlo</a></li>
<li><a class="" href="sol-mle.html"><span class="header-section-number">E</span> Solution: Model Answers: MLE</a></li>
<li><a class="" href="sol-ex-CI.html"><span class="header-section-number">F</span> Solution: Confidence Interval</a></li>
<li><a class="" href="solution-computational-testing.html"><span class="header-section-number">G</span> Solution: Computational Testing</a></li>
<li><a class="" href="representing_data-sol.html"><span class="header-section-number">H</span> Solution: Representing Data</a></li>
<li><a class="" href="solution-linear-regression-and-correlation.html"><span class="header-section-number">I</span> Solution: Linear regression and Correlation</a></li>
<li class="book-part">APPENDIX</li>
<li><a class="" href="start.html">Getting started in R and Rstudio</a></li>
<li><a class="" href="data-sets.html">Data sets</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/anasrana/ems-practicals">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="maximum-likelihood" class="section level1" number="5">
<h1>
<span class="header-section-number">5</span> Maximum Likelihood<a class="anchor" aria-label="anchor" href="#maximum-likelihood"><i class="fas fa-link"></i></a>
</h1>
<p>During the lectures, you saw how we could use a brute-force search of parameters to find the maximum likelihood estimate of an unknown mean for a Normal distribution given a set of data. In this exercise, we will now look at how we would do this more efficiently in real life.</p>
<div id="the-likelihood-function" class="section level2" number="5.1">
<h2>
<span class="header-section-number">5.1</span> The likelihood function<a class="anchor" aria-label="anchor" href="#the-likelihood-function"><i class="fas fa-link"></i></a>
</h2>
<p>First, we are going to write a function to compute the log-likelihood function given parameters:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb29-1"><a href="maximum-likelihood.html#cb29-1"></a>neglogLikelihood <span class="ot">&lt;-</span> <span class="cf">function</span>(mu, x) {</span>
<span id="cb29-2"><a href="maximum-likelihood.html#cb29-2"></a>  logF <span class="ot">=</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> mu, <span class="at">sd =</span> <span class="dv">1</span>, <span class="at">log =</span> <span class="cn">TRUE</span>)</span>
<span id="cb29-3"><a href="maximum-likelihood.html#cb29-3"></a>  <span class="fu">return</span>(<span class="sc">-</span><span class="fu">sum</span>(logF))</span>
<span id="cb29-4"><a href="maximum-likelihood.html#cb29-4"></a>}</span></code></pre></div>
<p>Note that this function returns the <code>-sum(logF)</code> because the numerical optimisation algorithm we are going to use finds the <em>minimum</em> of a function. We are interested in the <em>maximum</em> likelihood but we can turn this into a minimisation problem by simply negating the likelihood.</p>
<p>Now, lets assume our data is captured in the following vector:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb30-1"><a href="maximum-likelihood.html#cb30-1"></a>x <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">0.2</span>, <span class="sc">-</span><span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">0.89</span>, <span class="sc">-</span><span class="fl">0.11</span>, <span class="sc">-</span><span class="fl">0.71</span>, <span class="fl">1.0</span>, <span class="sc">-</span><span class="fl">1.3</span>, <span class="fl">0.84</span>)</span>
<span id="cb30-2"><a href="maximum-likelihood.html#cb30-2"></a>n <span class="ot">=</span> <span class="fu">length</span>(x)</span></code></pre></div>
</div>
<div id="optimisation" class="section level2" number="5.2">
<h2>
<span class="header-section-number">5.2</span> Optimisation<a class="anchor" aria-label="anchor" href="#optimisation"><i class="fas fa-link"></i></a>
</h2>
<p>Now, we will need to define an initial search value for the parameter, we will arbitrarily pick a value:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb31-1"><a href="maximum-likelihood.html#cb31-1"></a>mu_init <span class="ot">=</span> <span class="fl">1.0</span></span></code></pre></div>
<p>Now we will use the <code>R</code> function <code>optim</code> to find the maximum likelihood estimate. As mentioned above, <code>optim</code> finds the minimum value of a function so in this case we are trying to find the parameter that minimises the negative log likelihood.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb32-1"><a href="maximum-likelihood.html#cb32-1"></a>out <span class="ot">&lt;-</span> <span class="fu">optim</span>(mu_init, neglogLikelihood, <span class="at">gr =</span> <span class="cn">NULL</span>, x, <span class="at">method =</span> <span class="st">"L-BFGS-B"</span>,</span>
<span id="cb32-2"><a href="maximum-likelihood.html#cb32-2"></a>         <span class="at">lower =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">upper =</span> <span class="cn">Inf</span>)</span></code></pre></div>
<p>Here, this says that we will start the search at <code>mu_init</code> using the function <code>logLikelihood</code> that we have defined above. The <code>optim</code> algorithm will use the <code>L-BFGS-B</code> search method. The parameter is allowed to take any value from <code>lower = -Inf</code> to <code>upper = Inf</code>. The result is stored in out.</p>
<p>Once the optimiser has run, we can see what parameter value it has found:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb33-1"><a href="maximum-likelihood.html#cb33-1"></a><span class="fu">print</span>(out<span class="sc">$</span>par)</span></code></pre></div>
<pre class="bg-info"><code>#&gt; [1] 0.1372727</code></pre>
<p>which we can compare against the sample mean</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb35-1"><a href="maximum-likelihood.html#cb35-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(x))</span></code></pre></div>
<pre class="bg-info"><code>#&gt; [1] 0.1372727</code></pre>
<p>It turns out that it is theoretically known that the maximum likelihood estimate, for this particular problem, is the sample mean which is why they coincide!</p>
<p>We can visualise this further. First we define an array of possible values for <code>mu</code> in this case between -0.1 and 0.3 with 101 values in-between:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb37-1"><a href="maximum-likelihood.html#cb37-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="at">length =</span> <span class="dv">101</span>)</span></code></pre></div>
<p>We use the <code>apply</code> function to apply the <code>logLikelihood</code> function to each of the <code>mu</code> values we have defined. This means we do not need to use a for loop:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb38-1"><a href="maximum-likelihood.html#cb38-1"></a>neglogL <span class="ot">&lt;-</span> <span class="fu">apply</span>( <span class="fu">matrix</span>(mu), <span class="dv">1</span>, neglogLikelihood, x)</span></code></pre></div>
<p>We can then plot and overlay the maximum likelihood result:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb39-1"><a href="maximum-likelihood.html#cb39-1"></a><span class="fu">plot</span>(mu, neglogL, <span class="at">pch=</span><span class="st">"-"</span>)</span>
<span id="cb39-2"><a href="maximum-likelihood.html#cb39-2"></a><span class="fu">points</span>(out<span class="sc">$</span>par, out<span class="sc">$</span>value, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">pch=</span><span class="dv">0</span>)</span></code></pre></div>
<div class="inline-figure"><img src="mle_files/figure-html/unnamed-chunk-9-1.png" width="95%" style="display: block; margin: auto;"></div>
<p>The plot shows that <code>optim</code> has found the <code>mu</code> which minimises the negative log-likelihood.</p>
</div>
<div id="two-parameter-estimation" class="section level2" number="5.3">
<h2>
<span class="header-section-number">5.3</span> Two-parameter estimation<a class="anchor" aria-label="anchor" href="#two-parameter-estimation"><i class="fas fa-link"></i></a>
</h2>
<p>Now suppose both the mean and the variance of the Normal distribution are unknown and we need to search over two parameters for the maximum likelihood estimation.</p>
<p>We now need a modified negative log-likelihood function:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb40-1"><a href="maximum-likelihood.html#cb40-1"></a>neglogLikelihood2 <span class="ot">&lt;-</span> <span class="cf">function</span>(theta,x) {</span>
<span id="cb40-2"><a href="maximum-likelihood.html#cb40-2"></a>  mu <span class="ot">&lt;-</span> theta[<span class="dv">1</span>] <span class="co"># get value for mu</span></span>
<span id="cb40-3"><a href="maximum-likelihood.html#cb40-3"></a>  sigma2 <span class="ot">&lt;-</span> theta[<span class="dv">2</span>] <span class="co"># get value for sigma2</span></span>
<span id="cb40-4"><a href="maximum-likelihood.html#cb40-4"></a></span>
<span id="cb40-5"><a href="maximum-likelihood.html#cb40-5"></a>  <span class="co"># compute density for each data element in x</span></span>
<span id="cb40-6"><a href="maximum-likelihood.html#cb40-6"></a>  logF <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> mu, <span class="at">sd =</span> <span class="fu">sqrt</span>(sigma2), <span class="at">log =</span> <span class="cn">TRUE</span>)</span>
<span id="cb40-7"><a href="maximum-likelihood.html#cb40-7"></a></span>
<span id="cb40-8"><a href="maximum-likelihood.html#cb40-8"></a>  <span class="fu">return</span>(<span class="sc">-</span><span class="fu">sum</span>(logF)) <span class="co"># return negative log-likelihood</span></span>
<span id="cb40-9"><a href="maximum-likelihood.html#cb40-9"></a>}</span></code></pre></div>
<p>Notice that we pass through one argument <code>theta</code> whose elements are the parameters for <code>mu</code> and <code>sigma2</code> which we unpack within the function.</p>
<p>Now we can run <code>optim</code> but this time the initial parameters values must be initialised with two values. Furthermore, as variance cannot be negative, we bound the possible lower values that <code>sigma2</code> can take by setting <code>lower = c(-Inf, 0.001)</code>. The second argument means <code>sigma2</code> cannot be lower than 0.001:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb41-1"><a href="maximum-likelihood.html#cb41-1"></a>theta_init <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb41-2"><a href="maximum-likelihood.html#cb41-2"></a></span>
<span id="cb41-3"><a href="maximum-likelihood.html#cb41-3"></a>out <span class="ot">&lt;-</span> <span class="fu">optim</span>(theta_init, neglogLikelihood2, <span class="at">gr =</span> <span class="cn">NULL</span>, x, <span class="at">method =</span> <span class="st">"L-BFGS-B"</span>,</span>
<span id="cb41-4"><a href="maximum-likelihood.html#cb41-4"></a>        <span class="at">lower =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="fl">0.001</span>), <span class="at">upper =</span> <span class="fu">c</span>(<span class="cn">Inf</span>, <span class="cn">Inf</span>))</span></code></pre></div>
<p>We can now visualise the results by creating a two-dimensional contour plot. We first need to generate a grid of values for <code>mu</code> and <code>sigma2</code>:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb42-1"><a href="maximum-likelihood.html#cb42-1"></a><span class="co"># one dimensional grid of values for mu</span></span>
<span id="cb42-2"><a href="maximum-likelihood.html#cb42-2"></a>mu <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">1.0</span>, <span class="at">length =</span> <span class="dv">101</span>)</span>
<span id="cb42-3"><a href="maximum-likelihood.html#cb42-3"></a><span class="co"># one dimensional grid of values for sigma2</span></span>
<span id="cb42-4"><a href="maximum-likelihood.html#cb42-4"></a>sigma2 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">1.0</span>, <span class="at">length =</span> <span class="dv">101</span>)</span>
<span id="cb42-5"><a href="maximum-likelihood.html#cb42-5"></a></span>
<span id="cb42-6"><a href="maximum-likelihood.html#cb42-6"></a>mu_xx <span class="ot">&lt;-</span> <span class="fu">rep</span>(mu, <span class="at">each =</span> <span class="dv">101</span>) <span class="co"># replicate this 101 times</span></span>
<span id="cb42-7"><a href="maximum-likelihood.html#cb42-7"></a>sigma2_yy <span class="ot">&lt;-</span> <span class="fu">rep</span>(sigma2, <span class="at">times =</span> <span class="dv">101</span>) <span class="co"># replicate this 101 times</span></span>
<span id="cb42-8"><a href="maximum-likelihood.html#cb42-8"></a></span>
<span id="cb42-9"><a href="maximum-likelihood.html#cb42-9"></a><span class="co"># generate grid of values (each row contains a unique combination</span></span>
<span id="cb42-10"><a href="maximum-likelihood.html#cb42-10"></a><span class="co"># of mu and sigma2 values)</span></span>
<span id="cb42-11"><a href="maximum-likelihood.html#cb42-11"></a>mu_sigma_grid <span class="ot">&lt;-</span> <span class="fu">cbind</span>(mu_xx, sigma2_yy)</span></code></pre></div>
<p>Now we apply our negative log-likehood function to this grid to generate a negative log-likelihood value for each position on the grid:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb43-1"><a href="maximum-likelihood.html#cb43-1"></a>neglogL2 <span class="ot">&lt;-</span> <span class="fu">apply</span>(mu_sigma_grid, <span class="dv">1</span>, neglogLikelihood2, x)</span></code></pre></div>
<p>We now use the <code>contour</code> function to plot our results:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb44-1"><a href="maximum-likelihood.html#cb44-1"></a><span class="co"># convert vector of negative log-likelihood values into a grid</span></span>
<span id="cb44-2"><a href="maximum-likelihood.html#cb44-2"></a>neglogL2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(neglogL2, <span class="dv">101</span>)</span>
<span id="cb44-3"><a href="maximum-likelihood.html#cb44-3"></a></span>
<span id="cb44-4"><a href="maximum-likelihood.html#cb44-4"></a><span class="co"># draw contour plot</span></span>
<span id="cb44-5"><a href="maximum-likelihood.html#cb44-5"></a><span class="fu">contour</span>(sigma2, mu, neglogL2, <span class="at">nlevels =</span> <span class="dv">50</span>, <span class="at">xlab =</span> <span class="st">"sigma2"</span>, <span class="at">ylab =</span> <span class="st">"mu"</span>)</span>
<span id="cb44-6"><a href="maximum-likelihood.html#cb44-6"></a><span class="co"># overlay the maximum likelihood estimate as a red circle</span></span>
<span id="cb44-7"><a href="maximum-likelihood.html#cb44-7"></a><span class="fu">points</span>(out<span class="sc">$</span>par[<span class="dv">2</span>], out<span class="sc">$</span>par[<span class="dv">1</span>], <span class="at">col=</span><span class="st">"red"</span>)</span></code></pre></div>
<div class="inline-figure"><img src="mle_files/figure-html/unnamed-chunk-14-1.png" width="95%" style="display: block; margin: auto;"></div>
<p>Excellent! We have now found the maximum likelihood estimates for the unknown mean and variance for the Normal distribution that our data is assumed to be drawn from. Let’s compare our estimates against the sample mean and variance. First, the estimates:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb45-1"><a href="maximum-likelihood.html#cb45-1"></a><span class="fu">print</span>(out<span class="sc">$</span>par[<span class="dv">1</span>]) <span class="co"># mu estimate</span></span></code></pre></div>
<pre class="bg-info"><code>#&gt; [1] 0.1372727</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb47-1"><a href="maximum-likelihood.html#cb47-1"></a><span class="fu">print</span>(out<span class="sc">$</span>par[<span class="dv">2</span>]) <span class="co"># sigma2 estimate</span></span></code></pre></div>
<pre class="bg-info"><code>#&gt; [1] 0.5569665</code></pre>
<p>Now, the sample mean and variances:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb49-1"><a href="maximum-likelihood.html#cb49-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(x)) <span class="co"># sample mean</span></span></code></pre></div>
<pre class="bg-info"><code>#&gt; [1] 0.1372727</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb51-1"><a href="maximum-likelihood.html#cb51-1"></a><span class="fu">print</span>(<span class="fu">var</span>(x)) <span class="co"># sample variance (normalised by n-1)</span></span></code></pre></div>
<pre class="bg-info"><code>#&gt; [1] 0.6126618</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb53-1"><a href="maximum-likelihood.html#cb53-1"></a><span class="fu">print</span>(<span class="fu">var</span>(x)<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n) <span class="co"># sample variance (normalised by n)</span></span></code></pre></div>
<pre class="bg-info"><code>#&gt; [1] 0.5569653</code></pre>
<p>Interesting! The maximum likelihood estimates return the sample mean and the <strong>biased</strong> sample variance estimate (where we normalise by <span class="math inline">\(n\)</span>
and not <span class="math inline">\(n−1\)</span>). Indeed, it turns out that theoretically, the maximum likelihood estimate does give a biased estimate of the population variance.</p>
</div>
<div id="ex-mle" class="section level2 infobox" number="5.4">
<h2>
<span class="header-section-number">5.4</span> Exercise: MLE<a class="anchor" aria-label="anchor" href="#ex-mle"><i class="fas fa-link"></i></a>
</h2>
<p>A potentially biased coin is tossed 10 times and the number of heads recorded. The experiment is repeated 5 times and the number of heads recorded was 3, 2, 4, 5 and 2 respectively.</p>
<ul>
<li>Can you derive a maximum likelihood estimate of the probability of obtaining a head?</li>
</ul>
<button class="button">
<a href="sol-mle.html#sol-mle">Show solution</a>
</button>
</div>

</div>
  <div class="chapter-nav">
<div class="prev"><a href="monte-carlo-methods.html"><span class="header-section-number">4</span> Monte Carlo Methods</a></div>
<div class="next"><a href="confidence-intervals.html"><span class="header-section-number">6</span> Confidence Intervals</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#maximum-likelihood"><span class="header-section-number">5</span> Maximum Likelihood</a></li>
<li><a class="nav-link" href="#the-likelihood-function"><span class="header-section-number">5.1</span> The likelihood function</a></li>
<li><a class="nav-link" href="#optimisation"><span class="header-section-number">5.2</span> Optimisation</a></li>
<li><a class="nav-link" href="#two-parameter-estimation"><span class="header-section-number">5.3</span> Two-parameter estimation</a></li>
<li><a class="nav-link" href="#ex-mle"><span class="header-section-number">5.4</span> Exercise: MLE</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/anasrana/ems-practicals/blob/master/mle.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/anasrana/ems-practicals/edit/master/mle.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Essentials of Mathematics and Statistics</strong>" was written by Anas A Rana. It was last built on 2024-10-07.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
